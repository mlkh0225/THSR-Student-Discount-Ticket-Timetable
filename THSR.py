from datetime import datetime

baseDate = datetime(2015, 1, 4)
userDate = raw_input("Ride date (Ex:2015/02/25): ")
userDate = datetime.strptime(userDate, "%Y/%m/%d")
weekday = int((userDate-baseDate).days)%7-1

while int((userDate-baseDate).days)>116:
	userDate = raw_input("Timetable available till 2015/4/30. Enter new date: ")
	userDate = datetime.strptime(userDate, "%Y,%m,%d")
	weekday = int((userDate-baseDate).days)%7-1

specialTable = 0
table288 = 0

if ((userDate-baseDate).days >= 53) & ((userDate-baseDate).days <= 57):
	specialTable = 1
	table288 = 1

#print (userDate-baseDate).days

rideTime = int(raw_input("Ride time (24 hour without minutes): "))*60
#print rideTime
while (rideTime < 0) | (rideTime > 1440):
	rideTime = int(raw_input("No such time, 24 hours a day! Ride time: "))*60

rideTimeRange = int(raw_input("Show trains in next x hours: "))*60

print "Station number: 1-Taipei, 2-Banqiao, 3-Taoyuan, 4-Hsinchu, 5-Taichung, 6-Chiayi, 7-Tainan, 8-Zuoying"
stationStart = int(raw_input("From station number: "))
while (stationStart < 1) | (stationStart > 8):
	stationStart = int(raw_input("No such station! From station number: "))
stationEnd = int(raw_input("To station number: "))
while (stationEnd < 1) | (stationEnd > 8) | (stationEnd == stationStart):
	stationEnd = int(raw_input("No such station or same as departure! To station number: "))

stations = ["Taipei","Banqiao","Taoyuan","Hsinchu","Taichung","Chiayi","Tainan","Zuoying"]

d50t103 = [103,396,404,-1,-1,448,-1,-1,492,"50%"]
d50t111 = [111,450,458,-1,-1,502,-1,-1,546,"50%"]
d50t1247 = [1247,1194,1202,-1,-1,1246,-1,-1,1290,"50%"]
d50t139 = [139,654,662,-1,-1,706,-1,-1,750,"50%"]
d50t1505 = [1505,438,446,459,471,496,-1,-1,-1,"50%"]
d50t1529 = [1529,1128,1136,1149,1162,1189,-1,-1,-1,"50%"]
d50t1627 = [1627,558,566,579,591,619,644,663,678,"50%"]
d50t1635 = [1635,618,626,639,651,679,704,723,738,"50%"]
d50t1735 = [1735,1098,1106,1119,1131,1159,1184,1203,1218,"50%"]
d50t235 = [235,1110,1118,-1,-1,1162,-1,-1,1206,"50%"]
d50t255 = [255,1254,1262,-1,-1,1306,-1,-1,1350,"50%"]
d50t259 = [259,1290,1298,-1,-1,1342,-1,-1,1386,"50%"]
d50t399 = [399,1332,-1,1351,-1,1384,1408,1426,1439,"50%"]
d50t541 = [541,1350,1358,1372,1383,1410,-1,-1,-1,"50%"]
d50t545 = [545,1380,1388,1402,1413,1439,-1,-1,-1,"50%"]
d50t551 = [551,-1,-1,-1,-1,390,417,437,450,"50%"]
d50t605 = [605,390,398,412,425,452,477,496,510,"50%"]
d50t609 = [609,420,428,441,453,481,506,525,540,"50%"]
d50t613 = [613,456,464,477,490,518,542,561,576,"50%"]
d50t629 = [629,576,584,597,610,638,662,681,696,"50%"]
d50t637 = [637,636,644,657,670,698,722,741,756,"50%"]
d50t749 = [749,1200,1208,1221,1233,1261,1286,1305,1320,"50%"]
d50t753 = [753,1236,1244,1257,1270,1298,1322,1341,1356,"50%"]
d50t757 = [757,1260,1268,1281,1293,1321,1346,1365,1380,"50%"]
d50t761 = [761,1296,1304,1317,1330,1358,1382,1401,1416,"50%"]
d50t763 = [763,1314,1322,1335,1347,1375,1400,1419,1434,"50%"]
d70t103 = [103,396,404,-1,-1,448,-1,-1,492,"70%"]
d70t115 = [115,474,482,-1,-1,526,-1,-1,570,"70%"]
d70t1155 = [1155,774,782,-1,-1,826,-1,-1,870,"70%"]
d70t1223 = [1223,1014,1022,-1,-1,1066,-1,-1,1110,"70%"]
d70t123 = [123,534,542,-1,-1,586,-1,-1,630,"70%"]
d70t1233 = [1233,1092,1100,-1,-1,1144,-1,-1,1188,"70%"]
d70t1247 = [1247,1194,1202,-1,-1,1246,-1,-1,1290,"70%"]
d70t131 = [131,594,602,-1,-1,646,-1,-1,690,"70%"]
d70t139 = [139,654,662,-1,-1,706,-1,-1,750,"70%"]
d70t143 = [143,690,698,-1,-1,742,-1,-1,786,"70%"]
d70t1521 = [1521,918,926,939,951,976,-1,-1,-1,"70%"]
d70t1523 = [1523,1008,1016,1029,1042,1069,-1,-1,-1,"70%"]
d70t1525 = [1525,1038,1046,1059,1071,1096,-1,-1,-1,"70%"]
d70t1527 = [1527,1068,1076,1089,1102,1129,-1,-1,-1,"70%"]
d70t1529 = [1529,1128,1136,1149,1162,1189,-1,-1,-1,"70%"]
d70t1611 = [1611,438,446,459,471,499,524,543,558,"70%"]
d70t1615 = [1615,468,476,489,502,530,554,573,588,"70%"]
d70t1619 = [1619,498,506,519,531,559,584,603,618,"70%"]
d70t1627 = [1627,558,566,579,591,619,644,663,678,"70%"]
d70t1635 = [1635,618,626,639,651,679,704,723,738,"70%"]
d70t1727 = [1727,1038,1046,1059,1071,1099,1124,1143,1158,"70%"]
d70t1735 = [1735,1098,1106,1119,1131,1159,1184,1203,1218,"70%"]
d70t1743 = [1743,1158,1166,1179,1191,1219,1244,1263,1278,"70%"]
d70t1751 = [1751,1218,1226,1239,1251,1279,1304,1323,1338,"70%"]
d70t227 = [227,1050,1058,-1,-1,1102,-1,-1,1146,"70%"]
d70t231 = [231,1074,1082,-1,-1,1126,-1,-1,1170,"70%"]
d70t239 = [239,1134,1142,-1,-1,1186,-1,-1,1230,"70%"]
d70t243 = [243,1170,1178,-1,-1,1222,-1,-1,1266,"70%"]
d70t251 = [251,1230,1238,-1,-1,1282,-1,-1,1326,"70%"]
d70t255 = [255,1254,1262,-1,-1,1306,-1,-1,1350,"70%"]
d70t259 = [259,1290,1298,-1,-1,1342,-1,-1,1386,"70%"]
d70t399 = [399,1332,-1,1351,-1,1384,1408,1426,1439,"70%"]
d70t541 = [541,1350,1358,1372,1383,1410,-1,-1,-1,"70%"]
d70t545 = [545,1380,1388,1402,1413,1439,-1,-1,-1,"70%"]
d70t605 = [605,390,398,412,425,452,477,496,510,"70%"]
d70t613 = [613,456,464,477,490,518,542,561,576,"70%"]
d70t617 = [617,480,488,501,513,541,566,585,600,"70%"]
d70t621 = [621,516,524,537,550,578,602,621,636,"70%"]
d70t625 = [625,540,548,561,573,601,626,645,660,"70%"]
d70t629 = [629,576,584,597,610,638,662,681,696,"70%"]
d70t633 = [633,600,608,621,633,661,686,705,720,"70%"]
d70t637 = [637,636,644,657,670,698,722,741,756,"70%"]
d70t641 = [641,660,668,681,693,721,746,765,780,"70%"]
d70t645 = [645,696,704,717,730,758,782,801,816,"70%"]
d70t733 = [733,1080,1088,1101,1113,1141,1166,1185,1200,"70%"]
d70t741 = [741,1140,1148,1161,1173,1201,1226,1247,1260,"70%"]
d70t749 = [749,1200,1208,1221,1233,1261,1286,1305,1320,"70%"]
d70t753 = [753,1236,1244,1257,1270,1298,1322,1341,1356,"70%"]
d70t757 = [757,1260,1268,1281,1293,1321,1346,1365,1380,"70%"]
d70t761 = [761,1296,1304,1317,1330,1358,1382,1401,1416,"70%"]
d70t763 = [763,1314,1322,1335,1347,1375,1400,1419,1434,"70%"]

d50t110 = [110,546,538,-1,-1,495,-1,-1,450,"50%"]
d50t1512 = [1512,558,551,538,526,499,-1,-1,-1,"50%"]
d50t1618 = [1618,618,611,598,586,559,534,513,498,"50%"]
d50t1750 = [1750,1338,1331,1318,1306,1279,1254,1233,1218,"50%"]
d50t246 = [246,1290,1282,-1,-1,1239,-1,-1,1194,"50%"]
d50t254 = [254,1350,1342,-1,-1,1299,-1,-1,1254,"50%"]
d50t334 = [334,1439,1433,-1,-1,1390,1365,1345,1332,"50%"]
d50t502 = [502,450,443,429,417,390,-1,-1,-1,"50%"]
d50t506 = [506,480,473,459,447,420,-1,-1,-1,"50%"]
d50t596 = [596,-1,-1,-1,-1,1439,1415,1395,1380,"50%"]
d50t604 = [604,516,509,496,484,457,431,411,396,"50%"]
d50t608 = [608,540,533,520,508,481,456,435,420,"50%"]
d50t620 = [620,636,629,616,603,575,549,529,516,"50%"]
d50t752 = [752,1356,1349,1336,1323,1295,1269,1249,1236,"50%"]
d50t756 = [756,1380,1373,1360,1348,1321,1296,1275,1260,"50%"]
d50t762 = [762,1434,1427,1414,1402,1375,1350,1329,1314,"50%"]
d70t114 = [114,570,562,-1,-1,519,-1,-1,474,"70%"]
d70t1154 = [1154,870,862,-1,-1,819,-1,-1,774,"70%"]
d70t118 = [118,606,598,-1,-1,555,-1,-1,510,"70%"]
d70t1206 = [1206,990,982,-1,-1,939,-1,-1,894,"70%"]
d70t122 = [122,630,622,-1,-1,579,-1,-1,534,"70%"]
d70t130 = [130,690,682,-1,-1,639,-1,-1,594,"70%"]
d70t134 = [134,726,718,-1,-1,675,-1,-1,630,"70%"]
d70t138 = [138,750,742,-1,-1,699,-1,-1,654,"70%"]
d70t142 = [142,786,778,-1,-1,735,-1,-1,690,"70%"]
d70t1508 = [1508,492,485,471,459,432,-1,-1,-1,"70%"]
d70t1510 = [1510,528,521,507,495,468,-1,-1,-1,"70%"]
d70t1512 = [1512,558,551,538,526,499,-1,-1,-1,"70%"]
d70t1516 = [1516,678,671,658,646,619,-1,-1,-1,"70%"]
d70t1524 = [1524,1014,1007,994,981,952,-1,-1,-1,"70%"]
d70t1526 = [1526,1074,1067,1054,1041,1012,-1,-1,-1,"70%"]
d70t1528 = [1528,1128,1121,1107,1095,1068,-1,-1,-1,"70%"]
d70t1530 = [1530,1188,1180,1167,1155,1129,-1,-1,-1,"70%"]
d70t1540 = [1540,504,497,485,472,444,-1,-1,-1,"70%"]
d70t1618 = [1618,618,611,598,586,559,534,513,498,"70%"]
d70t1710 = [1710,1038,1031,1018,1006,979,954,933,918,"70%"]
d70t1726 = [1726,1158,1151,1138,1126,1099,1074,1053,1038,"70%"]
d70t1734 = [1734,1218,1211,1198,1186,1159,1134,1113,1098,"70%"]
d70t1742 = [1742,1278,1271,1258,1246,1219,1194,1173,1158,"70%"]
d70t222 = [222,1110,1102,-1,-1,1059,-1,-1,1014,"70%"]
d70t226 = [226,1146,1138,-1,-1,1095,-1,-1,1050,"70%"]
d70t230 = [230,1170,1162,-1,-1,1119,-1,-1,1074,"70%"]
d70t234 = [234,1206,1198,-1,-1,1155,-1,-1,1110,"70%"]
d70t238 = [238,1230,1222,-1,-1,1179,-1,-1,1134,"70%"]
d70t242 = [242,1266,1258,-1,-1,1215,-1,-1,1170,"70%"]
d70t246 = [246,1290,1282,-1,-1,1239,-1,-1,1194,"70%"]
d70t250 = [250,1326,1318,-1,-1,1275,-1,-1,1230,"70%"]
d70t254 = [254,1350,1342,-1,-1,1299,-1,-1,1254,"70%"]
d70t334 = [334,1439,1433,-1,-1,1390,1365,1345,1332,"70%"]
d70t502 = [502,450,443,429,417,390,-1,-1,-1,"70%"]
d70t506 = [506,480,473,459,447,420,-1,-1,-1,"70%"]
d70t604 = [604,516,509,496,484,457,431,411,396,"70%"]
d70t608 = [608,540,533,520,508,481,456,435,420,"70%"]
d70t612 = [612,576,569,556,543,515,489,469,456,"70%"]
d70t620 = [620,636,629,616,603,575,549,529,516,"70%"]
d70t624 = [624,660,653,640,628,601,576,555,540,"70%"]
d70t628 = [628,696,689,676,663,635,609,589,576,"70%"]
d70t632 = [632,720,713,700,688,661,636,615,600,"70%"]
d70t636 = [636,756,749,736,723,695,669,649,636,"70%"]
d70t640 = [640,780,773,760,748,721,696,675,660,"70%"]
d70t656 = [656,900,893,880,868,841,816,795,780,"70%"]
d70t728 = [728,1176,1169,1156,1143,1115,1089,1069,1056,"70%"]
d70t736 = [736,1236,1229,1216,1203,1175,1149,1129,1116,"70%"]
d70t744 = [744,1296,1289,1276,1263,1235,1209,1189,1176,"70%"]
d70t748 = [748,1320,1313,1300,1288,1261,1236,1215,1200,"70%"]
d70t752 = [752,1356,1349,1336,1323,1295,1269,1249,1236,"70%"]
d70t756 = [756,1380,1373,1360,1348,1321,1296,1275,1260,"70%"]
d70t762 = [762,1434,1427,1414,1402,1375,1350,1329,1314,"70%"]

Mon = [d50t551,d50t1505,d70t1615,d70t1619,d70t621,d70t123,d50t1627,d50t629,d70t131,d70t633,d70t1525,d70t231,d70t733,d70t239,d70t1529,d70t741,d70t255,d70t757,d70t259,d50t761,d50t763,d50t399,d50t541,d50t545,d50t752,d50t254,d50t762,d50t334,d50t596,d70t604,d70t1510,d70t1512,d70t620,d70t122,d70t628,d70t130,d70t632,d70t1526,d70t230,d70t736,d70t238,d70t744,d70t246,d70t748]
Tue = [d50t551,d50t1505,d70t1615,d70t123,d50t1627,d50t629,d70t131,d70t633,d70t139,d70t641,d70t1525,d70t231,d70t733,d70t239,d70t1529,d70t741,d50t255,d50t757,d50t259,d50t761,d50t763,d50t399,d50t541,d50t545,d50t1512,d50t246,d50t752,d50t254,d50t756,d50t762,d50t334,d50t596,d70t502,d70t1508,d70t1510,d70t620,d70t122,d70t628,d70t130,d70t632,d70t134,d70t640,d70t142,d70t1526,d70t230,d70t736,d70t238,d70t744,d70t246,d70t748]
Wed = [d50t551,d50t1505,d70t1615,d50t1627,d50t629,d70t131,d70t633,d70t139,d70t641,d70t1525,d70t231,d70t733,d70t239,d70t1529,d70t741,d70t255,d70t757,d70t259,d70t761,d50t763,d50t399,d50t541,d50t545,d50t1512,d50t246,d50t752,d50t254,d50t756,d50t762,d50t334,d50t596,d70t502,d70t1508,d70t1510,d70t620,d70t122,d70t628,d70t130,d70t632,d70t134,d70t640,d70t142,d70t1526,d70t230,d70t736,d70t238,d70t744,d70t246,d70t748]
Thu = [d50t551,d50t1505,d70t1627,d70t629,d70t131,d70t633,d70t641,d70t645,d70t1525,d70t239,d70t1529,d70t741,d70t255,d70t761,d50t763,d50t399,d50t541,d50t545,d50t1512,d50t752,d50t254,d50t762,d50t334,d50t596,d70t502,d70t1508,d70t1510,d70t620,d70t122,d70t628,d70t130,d70t632,d70t134,d70t640,d70t142,d70t230,d70t736,d70t238,d70t744,d70t246,d70t748]
Fri = [d50t551,d50t1505,d70t629,d70t131,d70t633,d70t637,d70t1155,d70t1521,d70t1527,d70t255,d70t763,d70t545,d50t596,d70t502,d70t1508,d70t1510,d70t1512,d70t122,d70t628,d70t130,d70t632,d70t134,d70t636,d70t1206,d70t1710,d70t1528,d70t1530,d70t1742,d70t752,d70t254,d70t756,d70t762,d70t334]
Sat = [d50t551,d70t1635,d70t637,d70t1223,d70t231,d70t239,d70t741,d50t1247,d50t749,d50t753,d50t255,d70t757,d70t259,d70t763,d70t399,d70t541,d70t545,d50t1750,d50t752,d50t596,d70t502,d70t1510,d70t1516,d70t1154,d70t656,d70t1206,d70t222,d70t728,d70t230,d70t736,d70t238,d70t744,d70t246,d70t254,d70t756]
Sun = [d50t551,d70t103,d70t605,d70t123,d70t131,d70t633,d50t1635,d50t637,d50t139,d70t641,d70t143,d70t645,d70t1523,d70t1233,d70t1735,d70t1743,d70t763,d70t399,d70t541,d70t545,d50t502,d50t604,d50t1618,d50t620,d50t596,d70t608,d70t612,d70t628,d70t130,d70t636,d70t138,d70t640,d70t1524,d70t1526,d70t762,d70t334]

week = [Mon,Tue,Wed,Thu,Fri,Sat,Sun]

Mon228 = [d50t551,d50t1505,d50t1529,d50t763,d50t399,d50t541,d50t545,d70t1615,d70t1619,d70t621,d70t1627,d70t629,d70t641,d70t231,d70t733,d70t239,d70t741,d70t255,d70t757,d70t259,d70t761,d70t1540,d70t1512,d70t1526,d70t728,d70t230,d70t238,d70t744,d70t246,d70t752,d70t254,d50t762,d50t334,d70t334,d50t596]
Tue228 = []
Wed228 = []
Thu228 = [d50t551,d50t1505,d50t1627,d50t629,d70t605,d70t103,d70t1615,d70t131,d70t633,d70t139,d70t641,d70t502,d70t506,d70t1508,d70t604,d70t1510,d70t1512,d70t122,d70t624,d70t130,d70t632,d70t636,d70t138,d70t334,d50t596]
Fri228 = [d50t551,d50t1735,d50t235,d70t1743,d70t243,d70t1751,d70t251,d70t255,d70t757,d70t502,d70t506,d70t226,d70t1726,d70t234,d70t1734,d70t242,d70t1742,d70t250,d70t752,d70t254,d70t756,d70t762,d70t334,d50t596]
Sat228 = [d50t551,d70t1611,d70t613,d70t115,d70t1619,d70t1635,d70t637,d70t139,d70t1247,d70t749,d70t1751,d70t753,d70t761,d70t763,d70t399,d70t541,d70t545,d70t502,d70t506,d70t604,d70t608,d70t114,d70t1618,d70t620,d70t122,d70t138,d70t640,d70t762,d50t596]
Sun228 = [d50t551,d50t605,d50t103,d50t609,d50t111,d50t613,d50t541,d50t545,d70t115,d70t617,d70t123,d70t625,d70t131,d70t633,d70t139,d70t641,d70t1727,d70t227,d70t761,d70t763,d70t399,d50t502,d50t506,d50t604,d50t608,d50t110,d70t114,d70t118,d50t1618,d70t620,d50t596]

week228 = [Mon228,Tue228,Wed228,Thu228,Fri228,Sat228,Sun228]

counter = 0

if specialTable == 0:
	for x in range(0, len(week[weekday])):
		if (week[weekday][x][stationEnd]-week[weekday][x][stationStart] > 0) & (week[weekday][x][stationStart] > rideTime) & (week[weekday][x][stationEnd] > 0) & (week[weekday][x][stationStart]<(rideTime+rideTimeRange)):
			print '{:>4}'.format(str(week[weekday][x][0]))+" "+'{:>8}'.format(stations[(stationStart-1)])+"("+'{:>2}'.format(str(week[weekday][x][stationStart]/60))+":"+'{:>2}'.format(str(week[weekday][x][stationStart]%60))+")  -> "+'{:>8}'.format(stations[(stationEnd-1)])+"("+'{:>2}'.format(str(week[weekday][x][stationEnd]/60))+":"+'{:>2}'.format(str(week[weekday][x][stationEnd]%60))+")  Discount: "+week[weekday][x][9]
			counter=counter+1

elif table288 == 1:
	print "228 Timetable"
	for x in range(0, len(week228[weekday])):
			if (week228[weekday][x][stationEnd]-week228[weekday][x][stationStart] > 0) & (week228[weekday][x][stationStart] > rideTime) & (week228[weekday][x][stationEnd] > 0) & (week228[weekday][x][stationStart]<(rideTime+rideTimeRange)):
				print '{:>4}'.format(str(week228[weekday][x][0]))+" "+'{:>8}'.format(stations[(stationStart-1)])+"("+'{:>2}'.format(str(week228[weekday][x][stationStart]/60))+":"+'{:>2}'.format(str(week228[weekday][x][stationStart]%60))+")  -> "+'{:>8}'.format(stations[(stationEnd-1)])+"("+'{:>2}'.format(str(week228[weekday][x][stationEnd]/60))+":"+'{:>2}'.format(str(week228[weekday][x][stationEnd]%60))+")  Discount: "+week228[weekday][x][9]
				counter=counter+1

if counter == 0:
	print "No available train, try again."